<!doctype html><html class=""><head><script async="" src="https://www.google-analytics.com/analytics.js"></script><script>
            window.GoogleAnalyticsObject="ga";(window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments);}),(window.ga.l=1*new Date());

            ga('create', 'UA-45256157-16', 'auto');
            ga('send', 'pageview');</script><script type="module" src="/i18n.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"/>
<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="description" content="A static site generator powered by Deno + React"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" property="og:title" content="Plugins · Pagic"/><meta data-react-helmet="true" property="og:description" content="A static site generator powered by Deno + React"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary"/>
<title data-react-helmet="true">Plugins · Pagic</title>
<link data-react-helmet="true" rel="stylesheet" href="/assets/index.css"/><link data-react-helmet="true" id="prismTheme" rel="stylesheet" href="/assets/prism.css"/>
<script data-react-helmet="true" >
    const shouldSetIsDark = document.cookie.includes('is_dark=1') ? true : document.cookie.includes('is_dark=0') ? false : window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (shouldSetIsDark) {
      document.documentElement.classList.add('is_dark');
      document.getElementById('prismTheme').href = "/assets/prism_tomorrow.css";
    }
  </script>
</head><body><header><h1 class="hide_on_mobile"><a href="/">Pagic</a></h1><nav><ul><li class="show_on_mobile flex_center"><a class="czs-menu-l" href="#" style="background-image:url(&quot;/assets/czs-menu-l.svg&quot;)"></a></li><li class="show_on_mobile"><h1 class="mobile_title"><a href="/">Pagic</a></h1></li><li class="hide_on_mobile"><a href="/docs/introduction.html">Docs</a></li><li class="hide_on_mobile"><a href="/themes/index.html">Themes</a></li><li class="hide_on_mobile"><a href="/plugins/index.html">Plugins</a></li><li class="hide_on_mobile"><a href="/blog/index.html">Blog</a></li><li class="hide_on_mobile"><a href="/about/index.html">About</a></li><li style="flex-grow:1"></li><li class="flex_center"><a class="czs-github-logo" href="https://github.com/xcatliu/pagic" target="_blank" style="background-image:url(&quot;/assets/czs-github-logo.svg&quot;)"></a></li><li class="flex_center"><select><option value="en" selected="">English</option><option value="zh-CN">简体中文</option></select></li><li class="toggle_dark flex_center"><span class="czs-sun" style="background-image:url(&quot;/assets/czs-sun.svg&quot;)"></span><span class="czs-sun-l" style="background-image:url(&quot;/assets/czs-sun-l.svg&quot;)"></span><span class="czs-moon" style="background-image:url(&quot;/assets/czs-moon.svg&quot;)"></span><span class="czs-moon-l" style="background-image:url(&quot;/assets/czs-moon-l.svg&quot;)"></span></li></ul></nav></header><aside class="sidebar"><ol class="list_style_none"><li class=""><a href="/docs/introduction.html" class="nav_link">Introduction</a></li><li class=""><a href="/docs/usage.html" class="nav_link">Usage</a></li><li class=""><a href="/docs/config.html" class="nav_link">Config</a></li><li class=""><a href="/docs/content.html" class="nav_link">Content</a></li><li class=""><a href="/docs/layout.html" class="nav_link">_layout.tsx</a></li><li class=""><a href="/docs/themes.html" class="nav_link">Themes</a></li><li class=""><a href="/docs/plugins.html" class="nav_link active">Plugins</a></li><li class=""><a href="/docs/blog.html" class="nav_link">Blog</a></li><li class=""><a href="/docs/i18n.html" class="nav_link">Internationalization</a></li><li class=""><a href="/docs/deployment.html" class="nav_link">Deployment</a></li><li class=""><a href="/docs/demos.html" class="nav_link">Demos</a></li><li class=""><a href="/docs/limitations.html" class="nav_link">Limitations</a></li></ol></aside><section class="main"><div class="main_article"><article><h1>Plugins</h1>
<p>This chapter will introduce how to use plugins and how to develop plugins.</p>
<p>If you want to see a list of all plugins and their documentation, please visit <a href="/plugins/">plugins list</a>.</p>
<h2 id="how-to-use">How to use<a class="anchor" href="#how-to-use">§</a></h2>
<p>The plugin is configured in <code>pagic.config.ts</code> through <code>plugins</code>, its type is <code>string[]</code>.</p>
<p>According to the level of the plugin, plugins can be divided into built-in plugins, official plugins and third-party plugins.</p>
<h3 id="built-in-plugins">Built-in plugins<a class="anchor" href="#built-in-plugins">§</a></h3>
<p>Built-in plugins (also called default plugins) are the most important plugins, they make up the entire Pagic build process, in other words, the entire Pagic build process is split into built-in plugins.</p>
<p>The built-in plugins include <code>['clean','init','md','tsx','script','layout','out']</code>, the construction process of Pagic also follows this order:</p>
<ol>
<li><code>clean</code>: Empty the <code>dist</code> directory</li>
<li><code>init</code>: Initialize intermediate variables (<code>pagePropsMap</code>)</li>
<li><code>md</code>: Parse the <code>md</code> file and update the intermediate variables</li>
<li><code>tsx</code>: Parse <code>tsx</code> files and update intermediate variables</li>
<li><code>script</code>: Compile <code>tsx</code> files to generate <code>pagic.config.js</code>, <code>index.js</code>, <code>*_props.js</code>, <code>*_content.js</code> and other files</li>
<li><code>layout</code>: Parse the <code>_layout.tsx</code> file and use the <code>Layout</code> component to render</li>
<li><code>out</code>: Generate HTML files, copy static resources</li>
</ol>
<blockquote>
<p>In fact, there are some steps before step 1: parsing <code>pagic.config.ts</code>, scanning the project directory, finding page files and template files. However, due to some operating mechanisms, they cannot be split into plugins.</p>
</blockquote>
<p>The built-in plugin is enabled by default, you don't need to add configuration to enable it.</p>
<p>By configuring items beginning with <code>-</code>, you can delete the default plugins, such as:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'-script'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>This configuration will delete the <code>script</code> plugin in the default <code>plugins</code>, so that the generated website does not have the React-related <code>&lt;script&gt;</code> tag, and it also loses the SPA ability when jumping between pages.</p>
<p>But for very simple websites, such as one-page-website, this configuration is very suitable.</p>
<p>If you delete the default plugin and then add a third-party plugin, we can even completely change Pagic's build process. For example, we can delete the <code>md</code> plugin, and then add a third-party plugin that parses markdown to replace the process of parsing markdown files.</p>
<h3 id="official-plugins">Official plugins<a class="anchor" href="#official-plugins">§</a></h3>
<p>In addition to built-in plugins, we also provide some commonly used official plugins, including:</p>
<ul>
<li><code>sidebar</code>: Used to parse the <code>sidebar</code> configured in <code>pagic.config.ts</code>, the theme will render sidebar after the parse is completed</li>
<li><code>prev_next</code>: Will get the link of previous page and the next page according to the configuration of <code>sidebar</code>, the theme will render it to the bottom of the article</li>
<li><code>ga</code>: Google Analytics plugin, the plugin will generate a <code>ReactElement</code>, the theme will inserted it into the page's <code>&lt;head&gt;</code></li>
<li><code>gitalk</code>: Add comment function to the page, the plugin will generate a <code>ReactElement</code>, the theme will insert it into the bottom of the page</li>
<li><code>blog</code>: Parse the <code>md/tsx</code> file as a post in the specified directory</li>
<li><code>i18n</code>: Internationalization plugin, which make the website support multiple languages</li>
</ul>
<p>The configuration of these plugins can be viewed in the <a href="./config.html#page-content">Config</a> chapter.</p>
<p>Official plugins can be added by configuring <code>plugins</code>.</p>
<p>It should be noted that the user-configured <code>plugins</code> will not replace the default <code>plugins</code>, but will be inserted into the default <code>plugins</code> according to a rule.</p>
<p>Take <a href="https://github.com/xcatliu/pagic/blob/master/pagic.config.tsx"><code>pagic.org</code> config file</a> as an example:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'sidebar'</span><span class="token punctuation">,</span> <span class="token string">'prev_next'</span><span class="token punctuation">,</span> <span class="token string">'ga'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>The inserted <code>plugins</code> are:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'clean'</span><span class="token punctuation">,</span> <span class="token string">'init'</span><span class="token punctuation">,</span> <span class="token string">'md'</span><span class="token punctuation">,</span> <span class="token string">'tsx'</span><span class="token punctuation">,</span> <span class="token string">'sidebar'</span><span class="token punctuation">,</span> <span class="token string">'prev_next'</span><span class="token punctuation">,</span> <span class="token string">'ga'</span><span class="token punctuation">,</span> <span class="token string">'script'</span><span class="token punctuation">,</span> <span class="token string">'layout'</span><span class="token punctuation">,</span> <span class="token string">'out'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h4 id="so-what-is-the-rules">So what is the rules?<a class="anchor" href="#so-what-is-the-rules">§</a></h4>
<p>It turns out that every <strong>non-built-in</strong> plugin will have an <code>insert</code> attribute, which describes the position when it is inserted, and its value is <code>before:xxx</code> or <code>after:xxx</code>, where <code>xxx</code> is one The name of the plugin. such as:</p>
<ul>
<li>The <code>insert</code> attribute of <code>sidebar</code> is <code>after:tsx</code>, so it will be inserted after <code>tsx</code></li>
<li>The <code>insert</code> attribute of <code>prev_next</code> is <code>after:sidebar</code>, so it will be inserted after <code>sidebar</code></li>
<li>The <code>insert</code> attribute of <code>ga</code> is <code>before:script</code>, so it will be inserted before <code>script</code></li>
</ul>
<p>Thanks to Pagic's splitting of the build process into built-in plugins, non-built-in plugins can be flexibly inserted into any position of the build. This design is more flexible and easier to understand than creating some &quot;hook functions&quot;.</p>
<h3 id="third-party-plugins">Third-party plugins<a class="anchor" href="#third-party-plugins">§</a></h3>
<p>When using third-party plugins, the items in the array should be an entry file URL:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'<a class="token url-link" href="https://raw.githubusercontent.com/xcatliu/pagic_plugin_custom/master/mod.ts">https://raw.githubusercontent.com/xcatliu/pagic_plugin_custom/master/mod.ts</a>'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="how-to-develop-a-plugin">How to develop a plugin<a class="anchor" href="#how-to-develop-a-plugin">§</a></h2>
<h3 id="plugin-structure">Plugin structure<a class="anchor" href="#plugin-structure">§</a></h3>
<p>A plugin must have a default export, the type is as follows:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">PagicPlugin</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  insert<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span>ctx<span class="token operator">:</span> Pagic<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Among them:</p>
<ul>
<li><code>name</code> is the name of the plugin. This name will be used when other plugins need to be inserted before or after this plugin</li>
<li><code>insert</code> is the position where the plugin is inserted, the value is <code>before:xxx</code> or <code>after:xxx</code>, where <code>xxx</code> is a plugin name</li>
<li>The <code>fn</code> function is the core logic of the plugin, and it accepts a parameter <code>pagic</code>, which is an instance of <code>Pagic</code></li>
</ul>
<blockquote>
<p>This naming rule refers to <a href="https://deno.land/manual/testing">Deno Testing's design</a></p>
</blockquote>
<h3 id="fn-function"><code>fn</code> function<a class="anchor" href="#fn-function">§</a></h3>
<p>The <code>fn</code> function is the core logic of the plugin. Since its parameter <code>pagic</code> is the currently running instance of <code>Pagic</code>, it can do almost anything, including but not limited to:</p>
<ul>
<li>Get configuration in <code>pagic.config.ts</code></li>
<li>Get the list of static resources</li>
<li>Get page list</li>
<li>Modify the <code>props</code> of the page</li>
<li>Write files to the <code>dist</code> directory</li>
<li>Import and run third-party modules</li>
</ul>
<p>For example, we can create a plugin that adds a prefix to the <code>title</code> of all pages:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token punctuation">{</span> PagicPlugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'<a class="token url-link" href="https://deno.land/x/pagic@v1.6.2/mod.ts">https://deno.land/x/pagic@v1.6.2/mod.ts</a>'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> prependTitle<span class="token operator">:</span> PagicPlugin <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'prepend_title'</span><span class="token punctuation">,</span>
  insert<span class="token operator">:</span> <span class="token string">'after:tsx'</span><span class="token punctuation">,</span>
<span class="highlighted-line">  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>pagic<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span></span><span class="highlighted-line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> pagePath <span class="token keyword">of</span> pagic<span class="token punctuation">.</span>pagePaths<span class="token punctuation">)</span> <span class="token punctuation">{</span></span><span class="highlighted-line">      <span class="token keyword">const</span> pageProps <span class="token operator">=</span> pagic<span class="token punctuation">.</span>pagePropsMap<span class="token punctuation">[</span>pagePath<span class="token punctuation">]</span><span class="token punctuation">;</span></span><span class="highlighted-line"></span><span class="highlighted-line">      pagic<span class="token punctuation">.</span>pagePropsMap<span class="token punctuation">[</span>pagePath<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span><span class="highlighted-line">        <span class="token operator">...</span>pageProps<span class="token punctuation">,</span></span><span class="highlighted-line">        title<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Prefix </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pageProps<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span></span><span class="highlighted-line">      <span class="token punctuation">}</span><span class="token punctuation">;</span></span><span class="highlighted-line">    <span class="token punctuation">}</span></span><span class="highlighted-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> prependTitle<span class="token punctuation">;</span>
</code></pre><p>In the above example,</p>
<ul>
<li><code>pagic.pagePaths</code> is the <em>temporary</em><sup><a href="#sup-1">[1]</a></sup> path of all scanned pages</li>
<li><code>pagic.pagePropsMap</code> is the <code>props</code> of all pages</li>
</ul>
<p>We loop through <code>pagic.pagePaths</code> through <code>for of</code>, and re-assign the <code>props</code> of each page, so that we can add a prefix to all pages.</p>
<p>In addition to these two attributes, <code>pagic</code> has many other attributes. The commonly used <code>pagic</code> attributes are listed below:</p>
<div class="table_wrapper"><table>
<thead>
<tr>
<th>Properties</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>config</code></td>
<td><code>PagicConfig</code></td>
<td>Pagic <em>runtime</em><sup><a href="#sup-2">[2]</a></sup> configuration</td>
</tr>
<tr>
<td><code>pagePaths</code></td>
<td><code>string[]</code></td>
<td><em>Temporary</em><sup><a href="#sup-1">[1]</a></sup> all scanned page paths</td>
</tr>
<tr>
<td><code>layoutPaths</code></td>
<td><code>string[]</code></td>
<td>All scanned templates (including themes)</td>
</tr>
<tr>
<td><code>staticPaths</code></td>
<td><code>string[]</code></td>
<td><em>Temporary</em><sup><a href="#sup-1">[1]</a></sup> all scanned static resources (including themes)</td>
</tr>
<tr>
<td><code>pagePropsMap</code></td>
<td><code>Record&lt;string, any&gt;</code></td>
<td><code>props</code> for all pages</td>
</tr>
<tr>
<td><code>writeFiles</code></td>
<td><code>Record&lt;string, string&gt;</code></td>
<td>Will be written to the <code>dist</code> directory in the <code>out</code> plugin</td>
</tr>
<tr>
<td><code>rebuilding</code></td>
<td><code>boolean</code></td>
<td><code>true</code> means rebuilding, <code>false</code> means incremental building</td>
</tr>
</tbody>
</table></div>
<p>Note that</p>
<h3 id="reference-official-plugin">Reference official plugin<a class="anchor" href="#reference-official-plugin">§</a></h3>
<p>The best reference for developing a plugin is the official plugin, you can directly <a href="https://github.com/xcatliu/pagic/tree/master/src/plugins">view the source code of the official plugin</a>.</p>
<h2 id="annotations">Annotations<a class="anchor" href="#annotations">§</a></h2>
<ol>
<li><span id="sup-1"></span> <code>pagePaths</code> and <code>staticPaths</code> are both <em>temporary</em>, that is to say, they only contain incremental during incremental builds (<code>--watch</code> mode)</li>
<li><span id="sup-2"></span> The <em>runtime</em> configuration of Pagic is slightly different from the configuration in <code>pagic.config.ts</code></li>
</ol></article><div class="prev_next"><a class="prev button" href="/docs/themes.html">«  Themes</a><a class="next button" href="/docs/blog.html">Blog  »</a></div></div><aside class="main_toc_container nav_link_container"><div class="main_toc"><nav class="toc"><ol><li><a href="#how-to-use">How to use</a><ol><li><a href="#built-in-plugins">Built-in plugins</a></li><li><a href="#official-plugins">Official plugins</a><ol></ol></li><li><a href="#third-party-plugins">Third-party plugins</a></li></ol></li><li><a href="#how-to-develop-a-plugin">How to develop a plugin</a><ol><li><a href="#plugin-structure">Plugin structure</a></li><li><a href="#fn-function">fn function</a></li><li><a href="#reference-official-plugin">Reference official plugin</a></li></ol></li><li><a href="#annotations">Annotations</a></li></ol></nav></div></aside></section><footer>Powered by&amp;nbsp;<a href="https://github.com/xcatliu/pagic" target="_blank">Pagic</a></footer><script src="https://cdn.pagic.org/react@18.2.0/umd/react.production.min.js"></script><script src="https://cdn.pagic.org/react-dom@18.2.0/umd/react-dom.production.min.js"></script><script type="module" src="/index.js"></script></body></html>